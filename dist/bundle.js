(()=>{"use strict";class t{_status=!1;_title;_description="";_date=new Date;_priority=1;_project=null;constructor(t,e,o,s){this.setTitle(t),this.setDescription(e),this.setDate(o),this.setPriority(s)}setTitle(t){void 0!==t&&(this._title=t.toString())}setDescription(t){void 0!==t&&(this._description=t.toString())}setDate(t){t instanceof Date&&(this._date=t)}setPriority(t){[1,2,3].includes(t)&&(this._priority=t)}setProject(t){this._project=t}setIndex(t){this._index=t}toggleStatus(){this._status=!this._status}getTitle(){return this._title}getDescription(){return this._description}getDate(){return this._date}getPriority(){return this._priority}getStatus(){return this._status}getProject(){return this._project}getIndex(t){return this._index}}function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function o(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function s(t){o(1,arguments);var s=function(t){o(1,arguments);var s=Object.prototype.toString.call(t);return t instanceof Date||"object"===e(t)&&"[object Date]"===s?new Date(t.getTime()):"number"==typeof t||"[object Number]"===s?new Date(t):("string"!=typeof t&&"[object String]"!==s||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}(t);return s.setHours(0,0,0,0),s}class i{constructor(t){void 0===t||t.length<1||(this.name=t.toString(),this.list=[])}getTodo(t){return this.list[t]}getAllTodos(){return this.list}getTodayTodos(){const t=new Date;return this.list.filter((e=>function(t,e){o(2,arguments);var i=s(t),r=s(e);return i.getTime()===r.getTime()}(e.getDate(),t)))}getHighPriorityTodos(){return this.list.filter((t=>3===t.getPriority()))}addTodo(e){if(!(e instanceof t))throw Error("todo must be instance of Todo class");e.setProject(this.name),this.list.push(e),this._reindex()}removeTodo(t){this.list.splice(t,1),this._reindex()}moveTodoUp(t){0!=t&&-1!=t&&this.list.splice(t-1,2,this.list[t],this.list[t-1])}moveTodoDown(t){t!=this.list.length-1&&-1!=t&&this.list.splice(t,2,this.list[t+1],this.list[t])}_reindex(){this.list.forEach(((t,e)=>{t.setIndex(e)}))}}const r=function(){let e;const o=()=>{JSON.parse(localStorage.getItem("todos")).forEach((o=>{e.addList(o.name),o.list.forEach((s=>{const i=new t;for(const t in s)i[t]="_date"==t?new Date(s[t]):s[t];e.getList(o.name).addTodo(i)}))}))},s=()=>{localStorage.clear(),localStorage.setItem("todos",JSON.stringify(e.getAllLists()))};return t=>(e=t,{load:o,save:s})}(),n=r,a=function(){let e,o=!1;function s(t){return t.map((t=>i(t)))}function i(t){return{title:t.getTitle(),description:t.getDescription(),date:t.getDate(),priority:t.getPriority(),status:t.getStatus(),project:t.getProject(),indexer:(e=t.getProject(),o=t.getIndex(),[e,o].join("-"))};var e,o}function r(t){return t.split("-")}const n={"move-up":t=>{const[o,s]=r(t);e.getList(o).moveTodoUp(Number(s))},"move-down":t=>{const[o,s]=r(t);e.getList(o).moveTodoDown(Number(s))},"delete-task":t=>{const[o,s]=r(t);e.getList(o).removeTodo(Number(s))},check:t=>{const[o,s]=r(t);e.getList(o).getTodo(Number(s)).toggleStatus()},edit:t=>{const[e,o]=r(t)},addNewTask:(o,s,i,r,n)=>{""===n&&(n=e.getDefaultProject());const a=new t(o,s,i,r);void 0!==a&&(e.getListNames().includes(n)||e.addList(n),e.getList(n).addTodo(a))},getListNames:()=>e.getListNames(),getTodosFromProject:t=>s(e.getList(t).getAllTodos()),getTodosFromFilter:t=>{switch(t.toLowerCase()){case"today":return s(e.getTodayTodos());case"high-priority":return s(e.getHighPriorityTodos());case"all":return s(e.getAllTodos())}},getNumTodayTodos:()=>e.getTodayTodos().length,getTodoByIndexer(t){const[o,s]=r(t);return i(e.getList(o).getTodo(s))},editTodo(t,o,s,i,n,a){const[d,l]=r(t),c=e.getList(d).getTodo(l);c.setTitle(o),c.setDescription(s),c.setDate(i),c.setPriority(n),d!==a&&(e.getListNames().includes(a)||e.addList(a),e.moveTodoToProject(d,l,a))}};return function(t){return 1==o||(o=!0,e=t),n}}(),d={page:{projects:document.querySelector("div.navbar div.projects"),filters:document.querySelector("div.navbar div.filters"),main:document.querySelector("div.main"),todos:document.querySelector("div.todos-container"),numTodayTodos:document.querySelector("div.head span#num-today-todos")},templProj:function(){const t=document.querySelector("template#project-template").content,e=t.querySelector("button.project-button");return{node:t,name:e}}(),templTodo:function(){const t=document.querySelector("template#todo-template").content,e=t.querySelector("div.todo"),o=t.querySelector("button.check span"),s=t.querySelector("p.todo-title"),i=t.querySelector("p.todo-description"),r=t.querySelector("span.date"),n=t.querySelector("span.project"),a=t.querySelector("#move-up"),d=t.querySelector("#move-down"),l=t.querySelector("#delete-task");return{node:t,todo:e,check:o,title:s,description:i,date:r,project:n,moveUp:a,moveDown:d,deleteButton:l}}(),templNewTodo:document.querySelector("template#new-todo").content,getNewTodoNodes:function(t){const e=t.querySelector("div.new-todo");return{showNewTask:t.querySelector("button#show-new-task"),node:e,form:t.querySelector("form"),title:t.querySelector("input#title"),description:t.querySelector("textarea#description"),date:t.querySelector("input#date"),project:t.querySelector("input#project"),priorityInputName:"priority",priorityRadios:[t.querySelector("input#priority1"),t.querySelector("input#priority2"),t.querySelector("input#priority3")],add:t.querySelector("button#add"),cancel:t.querySelector("button#cancel")}}},l=new class{constructor(){this.lists=[]}getIndexOfList(t){return this.lists.findIndex((e=>e.name==t))}getList(t){return this.lists.find((e=>e.name==t))}getAllLists(){return this.lists}getListNames(){return this.lists.map((t=>t.name))}getDefaultProject(){return this.lists.length>0?this.getListNames()[0]:(this.addList("General"),this.getList("General"))}addList(t){if(this.getListNames().includes(t))throw Error("List with this name already exists");this.lists.push(new i(t))}removeList(t){const e=this.getIndexOfList(t);-1!=e&&this.lists.splice(e,1)}moveTodoToProject(t,e,o){const s=this.getList(t).getTodo(e);this.getList(o).addTodo(s),this.getList(t).removeTodo(s)}getAllTodos(){let t=[];for(let e=0;e<this.lists.length;e++)t=[...t,...this.lists[e].getAllTodos()];return t}getTodayTodos(){let t=[];for(let e=0;e<this.lists.length;e++)t=[...t,...this.lists[e].getTodayTodos()];return t}getHighPriorityTodos(){let t=[];for(let e=0;e<this.lists.length;e++)t=[...t,...this.lists[e].getHighPriorityTodos()];return t}},c=n(l);0==localStorage.length?(l.addList("General"),l.getList("General").addTodo(new t("Wash dishes","Morning time while making coffee",new Date("2023-11-18"))),l.getList("General").addTodo(new t("Take fiber")),l.addList("Work"),l.getList("Work").addTodo(new t("Supervise exams","",new Date("2023-11-22"),3)),c.save()):c.load(),function(t,e,o="project",s="General"){const i=1,r=2;let n,a;"project"===o?n=i:"filter"==o&&(n=r);const{page:l,templProj:c,templTodo:u,templNewTodo:p,getNewTodoNodes:g}=d;function m(t){l.main.innerText="",t.forEach((t=>{u.check.textContent=!0===t.status?"check":"",u.title.textContent=t.title,u.description.textContent=t.description,u.date.textContent=t.date.toDateString(),u.project.textContent=t.project,u.todo.dataset.index=t.indexer;const e=u.todo.cloneNode(!0);l.main.appendChild(e)}))}function h(){a.showNewTask.classList.add("display-none"),a.node.classList.remove("display-none")}function y(e){e.preventDefault();const o=""===a.date.value?null:new Date(a.date.value),i=a.node.querySelector(`input[name='${a.priorityInputName}']:checked`).value,d=n===r?a.project.value:""===a.project.value?s:a.project.value;t.addNewTask(a.title.value,a.description.value,o,Number(i),d),T()}function T(){var o,r;e.save(),l.projects.innerText="",t.getListNames().forEach((t=>{c.name.textContent=t;const e=c.node.cloneNode(!0);l.projects.appendChild(e)})),n===i?(r=s,u.moveUp.classList.remove("display-none"),u.moveDown.classList.remove("display-none"),m(t.getTodosFromProject(r))):(o=s,u.moveUp.classList.add("display-none"),u.moveDown.classList.add("display-none"),m(t.getTodosFromFilter(o))),l.main.appendChild(p.cloneNode(!0)),a=g(l.main.lastElementChild),a.showNewTask.addEventListener("click",(t=>{h()})),a.form.addEventListener("submit",y),a.cancel.addEventListener("click",(()=>{T()})),l.numTodayTodos.textContent=t.getNumTodayTodos()}l.filters.addEventListener("click",(t=>{const e=t.target.closest("button");null!==e&&"filter-button"===e.className&&(n=r,s=e.id,T())})),l.projects.addEventListener("click",(t=>{"project-button"==t.target.className&&(n=i,s=t.target.textContent,T())})),l.main.addEventListener("click",(e=>{const o=e.target.closest("button"),s=e.target.closest("div.todo");if(null!==s)if(null!==o){if(void 0!==o.dataset.action){if(!(o.dataset.action in t))throw Error("The element has an action attribute but no programmed action");t[o.dataset.action](s.dataset.index),T()}}else!function(e){a.form.reset(),a.showNewTask.classList.remove("display-none"),a.node.classList.add("display-none"),l.main.replaceChild(a.node,e),h();const o=t.getTodoByIndexer(e.dataset.index);a.title.value=o.title,a.description.value=o.description,a.date.value=o.date.toISOString().slice(0,10),a.priorityRadios[o.priority-1].setAttribute("checked",!0),a.project.value=o.project,a.add.textContent="Update task",a.form.removeEventListener("submit",y),a.form.addEventListener("submit",(()=>{const o=""===a.date.value?null:new Date(a.date.value),s=a.node.querySelector(`input[name='${a.priorityInputName}']:checked`).value;t.editTodo(e.dataset.index,a.title.value,a.description.value,o,s,a.project.value),T()}))}(s)})),T()}(a(l),c,"project",l.getDefaultProject())})();
//# sourceMappingURL=bundle.js.map